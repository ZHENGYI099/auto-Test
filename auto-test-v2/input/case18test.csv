# Test Scenario: Test enable/disable plugin
Steps,Action,Expect result
1,"Install client agent with command msiexec /i cmdextension.msi SVCENV=""Test""",
2,"Wait for 2 minutest, and check log in C:\ProgramData\Microsoft\CMDExtension\Logs","There should be no ""CommonPostProvisioningPlugin.log"" and ""PawnPlugin.log"""
3,"Run powershell: $time = Get-Date

$versionstr = Get-Date -UFormat ""%Y%m.%d%H.%M%S""

$payload = ""{`""Type`"":1,`""PluginId`"":`""9c573ac5-3ad7-4680-81c1-3ec529ced175`"",`""RequestTime`"":`""""+$time+""`"",`""Payload`"":`""True`""}""

$policy = @{PluginId=""92611f58-44a1-4ff5-be2a-c27a53c15cd7"";PluginName=""PluginManagementPlugin"";PolicyId=""be8c130b-a7cb-42df-be90-344affa13e31"";Version=$versionstr;Status=""Initial"";Enabled=""True"";SchedulerMessage=""SMSSchedule;ScheduleString=58419D0000080001"";Payload=$payload}

swmi -Namespace ""root/cmd/clientagent"" -Class ""PluginPolicy"" -Arguments $policy > $null",
4,Check log in C:\ProgramData\Microsoft\CMDExtension\Logs\PluginManagementPlugin.log.,"There should be ""9c573ac5-3ad7-4680-81c1-3ec529ced175 is not valid for the partner: """
5,"Run powershell: $time = Get-Date

$versionstr = Get-Date -UFormat ""%Y%m.%d%H.%M%S""

$payload = ""{`""Type`"":1,`""PluginId`"":`""6251a87d-5ec4-4a5e-b836-f6c3a233b4e7`"",`""RequestTime`"":`""""+$time+""`"",`""Payload`"":`""True`""}""

$policy = @{PluginId=""92611f58-44a1-4ff5-be2a-c27a53c15cd7"";PluginName=""PluginManagementPlugin"";PolicyId=""be8c130b-a7cb-42df-be90-344affa13e31"";Version=$versionstr;Status=""Initial"";Enabled=""True"";SchedulerMessage=""SMSSchedule;ScheduleString=58419D0000080001"";Payload=$payload}

swmi -Namespace ""root/cmd/clientagent"" -Class ""PluginPolicy"" -Arguments $policy > $null",
6,Check log in C:\ProgramData\Microsoft\CMDExtension\Logs\PluginManagementPlugin.log,"There should be ""update pluginid(6251a87d-5ec4-4a5e-b836-f6c3a233b4e7) enable state to enabled success"""
7,"Run powershell: $time = Get-Date

$versionstr = Get-Date -UFormat ""%Y%m.%d%H.%M%S""

$payload = ""{`""Type`"":1,`""PluginId`"":`""caf0ee4a-1c93-4bdc-8644-746e94566750`"",`""RequestTime`"":`""""+$time+""`"",`""Payload`"":`""False`""}""

$policy = @{PluginId=""92611f58-44a1-4ff5-be2a-c27a53c15cd7"";PluginName=""PluginManagementPlugin"";PolicyId=""be8c130b-a7cb-42df-be90-344affa13e31"";Version=$versionstr;Status=""Initial"";Enabled=""True"";SchedulerMessage=""SMSSchedule;ScheduleString=58419D0000080001"";Payload=$payload}

swmi -Namespace ""root/cmd/clientagent"" -Class ""PluginPolicy"" -Arguments $policy > $null","There should be ""Infra plugin caf0ee4a-1c93-4bdc-8644-746e94566750 is not allowed to"""
8,"Test Cleanup:


Run command: msiexec /x cmdextension.msi",
