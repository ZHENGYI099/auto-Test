{
  "test_case_id": "case7",
  "test_scenario": "Check guardian task",
  "steps": [
    {
      "step": 1,
      "action": "Apply to all devices.",
      "expected": ""
    },
    {
      "step": 2,
      "action": "Press “Win + E” keys, open File Explorer, go to the folder where “cmdextension.msi” locates",
      "expected": ""
    },
    {
      "step": 3,
      "action": "In file explorer, click on “File -> Open Windows PowerShell -> Open Windows PowerShell as administrator”",
      "expected": ""
    },
    {
      "step": 4,
      "action": "Run command: msiexec /i cmdextension.msi /qn",
      "expected": ""
    },
    {
      "step": 5,
      "action": "Validation A:\nPress “Win + R” keys, type “taskschd.msc” and press Enter. \nOpen “Task scheduler library -> Microsoft -> CMD”, right click on “Cloud Managed Desktop Extension Health Evaluation -> Run”, refresh",
      "expected": "Verify Last Run Result is “The operation completed successfully”."
    },
    {
      "step": 6,
      "action": "Open file explorer, go to %ProgramData%\\Microsoft\\CMDExtension\\Logs.",
      "expected": "Verify “ClientHealth.log”, and verify below logs are printed with timestamp.\nThe client health report : [{\"ID\":\"a2f3177d-1f1d-4580-8b30-1eb4e8c0da69\",\"RuleEvaluationResult\":\"Pass\",\"ResultDetails\":null},{\"ID\":\"489f82c9-5b8f-4a71-aa51-109a1919b76b\",\"RuleEvaluationResult\":\"Pass\",\"ResultDetails\":null},{\"ID\":\"88d25de5-34da-4d58-9240-1d8e914ec641\",\"RuleEvaluationResult\":\"Pass\",\"ResultDetails\":null},{\"ID\":\"ad14a7c7-fd00-4820-a99f-fa561ff96c8f\",\"RuleEvaluationResult\":\"Fail\",\"ResultDetails\":\"Registry not found, it may be happened on agent installing/upgrading.\"}] ."
    },
    {
      "step": 7,
      "action": "Press “Win + R” keys, type “services.msc” and press Enter. Right click on “Microsoft Cloud Managed Desktop Extension -> Stop”, then rerun guardian task like “Validation A”.",
      "expected": ""
    },
    {
      "step": 8,
      "action": "Open file explorer, go to %ProgramData%\\Microsoft\\CMDExtension\\Logs.",
      "expected": "Verify “ClientHealth.log”, and verify below logs are printed with timestamp.\n\n·     Service is not running, current status is Stopped\n·     After trying remediation, current status is Running\n·     Summary: rule Verify/Remediate CMD Client Agent service running status. with ID 489f82c9-5b8f-4a71-aa51-109a1919b76b, result = PassAfterRemediation"
    },
    {
      "step": 9,
      "action": "Press “Win + R” keys, type “services.msc” and press Enter. Right click on “Microsoft Cloud Managed Desktop Extension -> Properties”, set \"Startup type\" as \"Disabled\" under General tab, then click \"Apply\". In the end, rerun guardian task like “Validation A”.",
      "expected": ""
    },
    {
      "step": 10,
      "action": "Open file explorer, go to %ProgramData%\\Microsoft\\CMDExtension\\Logs.",
      "expected": "Verify “ClientHealth.log”, and verify below logs are printed with timestamp.\n\n·     Service startup type is not automatic, current startup type is Disabled\n·     Set service startMode to delayed automatic.\n·     Summary: rule Verify/Remediate CMD Client Agent Service startup type. with ID 88d25de5-34da-4d58-9240-1d8e914ec641, result = PassAfterRemediation"
    },
    {
      "step": 11,
      "action": "Test Cleanup:\n\nIn the same powershell window as “Step 3”, run command: msiexec /x cmdextension.msi",
      "expected": ""
    }
  ]
}