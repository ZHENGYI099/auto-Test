{
  "test_case_id": "case1test",
  "generated_at": "2025-10-20T06:32:18Z",
  "model_deployment": "gpt-4.1",
  "steps": [
    {
      "step": 1,
      "action": "Apply to all devices.",
      "expected": "",
      "action_script": "",
      "verify_script": null,
      "need_vision_verify": false
    },
    {
      "step": 2,
      "action": "Press “Win + E” keys, open File Explorer, go to the folder where “cmdextension.msi” locates,cmdextension.msi locates in C:\\VMShare",
      "expected": "",
      "action_script": "Start-Process -FilePath 'explorer.exe' -ArgumentList 'C:\\VMShare'",
      "verify_script": null,
      "need_vision_verify": false
    },
    {
      "step": 3,
      "action": "In file explorer, click on “File -> Open Windows PowerShell -> Open Windows PowerShell as administrator”",
      "expected": "",
      "action_script": "Start-Process -FilePath 'powershell.exe' -Verb RunAs -WorkingDirectory 'C:\\VMShare'",
      "verify_script": null,
      "need_vision_verify": false
    },
    {
      "step": 4,
      "action": "Run command: msiexec /i cmdextension.msi /qn+",
      "expected": "The prompt window should pop up: Title is “Microsoft Cloud Manage Desktop Extension”, and Message is “Microsoft Cloud Managed Desktop Extension Setup completed successfully.”\n\nIf the step failed, run: msiexec /i cmdextension.msi /qn+ /l*v mylog. Send mylog to CMD Agent team for troubleshooting",
      "action_script": "Start-Process -FilePath 'msiexec.exe' -ArgumentList '/i','\"cmdextension.msi\"','/qn+','/l*v','\"C:\\VMShare\\cmdextension-install.log\"' -Wait -PassThru -NoNewWindow",
      "verify_script": "$s = Get-WmiObject -Class Win32_Service -Filter \"Name='CloudManagedDesktopExtension'\"; if ($s -and $s.State -eq 'Running') {exit 0} else {exit 1}",
      "need_vision_verify": false
    },
    {
      "step": 5,
      "action": "Open “Control Panel -> Programs -> Uninstall a program”",
      "expected": "Verify “Microsoft Cloud Managed Desktop Extension” is present in the list of installed programs.",
      "action_script": "",
      "verify_script": "if (Get-ItemProperty 'HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*','HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*','HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*' | Where-Object {$_.DisplayName -like '*Microsoft Cloud Managed Desktop Extension*'}) {exit 0} else {exit 1}",
      "need_vision_verify": false
    },
    {
      "step": 6,
      "action": "Open “Task Manager -> Services”",
      "expected": "Verify “CloudManagedDesktopExtension”\nis in running state.",
      "action_script": "",
      "verify_script": "$svc = Get-Service -Name 'CloudManagedDesktopExtension' -ErrorAction SilentlyContinue; if ($svc -and $svc.Status -eq 'Running') {exit 0} else {exit 1}",
      "need_vision_verify": false
    },
    {
      "step": 7,
      "action": "Press “Win + R” keys, type “services.msc” and press Enter.",
      "expected": "Verify “Microsoft Cloud Managed Desktop Extension” - Status is “Running”, Startup Type is “Automatic (Delayed Start)”, and Log On As is “Local System”.",
      "action_script": "",
      "verify_script": "$s=Get-WmiObject -Class Win32_Service -Filter \"Name='CloudManagedDesktopExtension'\"; if ($s -and $s.State -eq 'Running' -and $s.StartMode -eq 'Auto' -and ($s.DelayedAutoStart -eq $true) -and $s.StartName -eq 'LocalSystem') {exit 0} else {exit 1}",
      "need_vision_verify": false
    },
    {
      "step": 8,
      "action": "Open file explorer, go to %ProgramData%\\Microsoft\\CMDExtension\\Logs.",
      "expected": "Verify “CMDExtension.log” is present.",
      "action_script": "Start-Process -FilePath 'explorer.exe' -ArgumentList \"`\"%ProgramData%\\Microsoft\\CMDExtension\\Logs`\"\" -WorkingDirectory 'C:\\VMShare'",
      "verify_script": "if (Test-Path 'C:\\ProgramData\\Microsoft\\CMDExtension\\Logs\\CMDExtension.log') {exit 0} else {exit 1}",
      "need_vision_verify": false
    },
    {
      "step": 9,
      "action": "Press “Win + R” keys, type “taskschd.msc” and press Enter. Open “Task scheduler library -> Microsoft -> CMD”",
      "expected": "Verify “Cloud Managed Desktop Extension Health Evaluation” is present.",
      "action_script": "",
      "verify_script": "if (Get-ScheduledTask -TaskName 'Cloud Managed Desktop Extension Health Evaluation' -TaskPath '\\Microsoft\\CMD\\' -ErrorAction SilentlyContinue) {exit 0} else {exit 1}",
      "need_vision_verify": false
    },
    {
      "step": 10,
      "action": "Press “Win + R” keys, type “wbemtest” and press Enter. Click on “Connect”, type “root\\cmd\\clientagent” and press Enter.",
      "expected": "Verify there is NOT error prompt window which displays “Invalid namespace”.",
      "action_script": "",
      "verify_script": "if ((Get-WmiObject -Namespace 'root\\cmd\\clientagent' -List -ErrorAction SilentlyContinue)) {exit 0} else {exit 1}",
      "need_vision_verify": false
    },
    {
      "step": 11,
      "action": "Test Cleanup:\n\n\nIn the same PowerShell window as “Step 3”, run command: msiexec /x cmdextension.msi",
      "expected": "",
      "action_script": "Set-Location -LiteralPath 'C:\\VMShare'; $process=Start-Process -FilePath 'msiexec.exe' -ArgumentList '/x',\"`\"cmdextension.msi`\"\",'/qn','/l*v',\"`\"C:\\VMShare\\cmdextension_uninstall.log`\"\" -Wait -PassThru -NoNewWindow; $exitCode=$process.ExitCode",
      "verify_script": null,
      "need_vision_verify": false
    }
  ]
}